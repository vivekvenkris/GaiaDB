# -----------------------------------------------------------
# PostgreSQL config: single-user, max parallel query execution
# Tuned for read-heavy analytical workload (Gaia catalog)
# -----------------------------------------------------------

# Connection
listen_addresses = '*'
max_connections = 8

# Memory — sized for ~64 GB RAM container
shared_buffers = 16GB
effective_cache_size = 48GB
work_mem = 2GB
maintenance_work_mem = 4GB
huge_pages = try

# Parallelism — maximize for single-query throughput
max_worker_processes = 16
max_parallel_workers = 16
max_parallel_workers_per_gather = 14
max_parallel_maintenance_workers = 4
parallel_tuple_cost = 0.001
parallel_setup_cost = 100
min_parallel_table_scan_size = 1MB
min_parallel_index_scan_size = 256kB
force_parallel_mode = on

# Planner — encourage parallel & sequential scan on large tables
effective_io_concurrency = 200
random_page_cost = 1.1
seq_page_cost = 1.0
jit = on

# WAL — minimal since this is read-only / analytical
wal_level = minimal
max_wal_senders = 0
fsync = off
synchronous_commit = off
full_page_writes = off
checkpoint_timeout = 30min
max_wal_size = 4GB

# Logging
log_min_duration_statement = 1000
log_line_prefix = '%t [%p] '

# Temp files
temp_buffers = 256MB
